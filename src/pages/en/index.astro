---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('posts', ({ data }) => data.lang === 'en' && !data.draft))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<BaseLayout title="AngryPark - Personal Blog" description="Technical blog about machine learning, recommender systems, and deep learning">
  <section>
    <h1>AngryPark</h1>
    <p class="intro">Technical blog about machine learning, recommender systems, and deep learning.</p>

    <h2>Recent Posts</h2>
    <ul class="post-list">
      {posts.map((post) => (
        <li class="post-item">
          <h3 class="post-title">
            <a href={`/en/posts/${post.id.replace('en/', '')}/`}>{post.data.title}</a>
          </h3>
          <div class="post-meta">
            <time datetime={post.data.date.toISOString()}>
              {post.data.date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
              })}
            </time>
          </div>
          {post.data.description && (
            <p class="post-description">{post.data.description}</p>
          )}
          {post.data.tags && post.data.tags.length > 0 && (
            <div class="post-tags">
              {post.data.tags.map((tag) => (
                <span class="tag">{tag}</span>
              ))}
            </div>
          )}
        </li>
      ))}
    </ul>
  </section>
</BaseLayout>

<style>
  h1 {
    margin-top: 0;
  }

  .intro {
    color: var(--color-text-secondary);
    font-size: 1.1rem;
    margin-bottom: 2rem;
  }

  h2 {
    margin-top: 2rem;
    margin-bottom: 1.5rem;
  }
</style>
